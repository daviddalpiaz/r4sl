<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R for Statistical Learning</title>
  <meta name="description" content="<code>R</code> for Statistical Learning">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="R for Statistical Learning" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://daviddalpiaz.github.io/r4sl/" />
  
  
  <meta name="github-repo" content="daviddalpiaz/r4sl" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R for Statistical Learning" />
  
  
  

<meta name="author" content="David Dalpiaz">


<meta name="date" content="2017-09-05">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
<link rel="prev" href="regularized-discriminant-analysis.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R for Statistical Learning</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#about-this-book"><i class="fa fa-check"></i><b>0.1</b> About This Book</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#organization"><i class="fa fa-check"></i><b>0.2</b> Organization</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#who"><i class="fa fa-check"></i><b>0.3</b> Who?</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#caveat-emptor"><i class="fa fa-check"></i><b>0.4</b> Caveat Emptor</a></li>
<li class="chapter" data-level="0.5" data-path="index.html"><a href="index.html#conventions"><i class="fa fa-check"></i><b>0.5</b> Conventions</a></li>
<li class="chapter" data-level="0.6" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>0.6</b> Acknowledgements</a></li>
<li class="chapter" data-level="0.7" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i><b>0.7</b> License</a></li>
</ul></li>
<li class="part"><span><b>I Prerequisites</b></span></li>
<li class="chapter" data-level="1" data-path="prerequisites-overview.html"><a href="prerequisites-overview.html"><i class="fa fa-check"></i><b>1</b> Overview</a></li>
<li class="chapter" data-level="2" data-path="probability-review.html"><a href="probability-review.html"><i class="fa fa-check"></i><b>2</b> Probability Review</a><ul>
<li class="chapter" data-level="2.1" data-path="probability-review.html"><a href="probability-review.html#probability-models"><i class="fa fa-check"></i><b>2.1</b> Probability Models</a></li>
<li class="chapter" data-level="2.2" data-path="probability-review.html"><a href="probability-review.html#probability-axioms"><i class="fa fa-check"></i><b>2.2</b> Probability Axioms</a></li>
<li class="chapter" data-level="2.3" data-path="probability-review.html"><a href="probability-review.html#probability-rules"><i class="fa fa-check"></i><b>2.3</b> Probability Rules</a></li>
<li class="chapter" data-level="2.4" data-path="probability-review.html"><a href="probability-review.html#random-variables"><i class="fa fa-check"></i><b>2.4</b> Random Variables</a><ul>
<li class="chapter" data-level="2.4.1" data-path="probability-review.html"><a href="probability-review.html#distributions"><i class="fa fa-check"></i><b>2.4.1</b> Distributions</a></li>
<li class="chapter" data-level="2.4.2" data-path="probability-review.html"><a href="probability-review.html#discrete-random-variables"><i class="fa fa-check"></i><b>2.4.2</b> Discrete Random Variables</a></li>
<li class="chapter" data-level="2.4.3" data-path="probability-review.html"><a href="probability-review.html#continuous-random-variables"><i class="fa fa-check"></i><b>2.4.3</b> Continuous Random Variables</a></li>
<li class="chapter" data-level="2.4.4" data-path="probability-review.html"><a href="probability-review.html#several-random-variables"><i class="fa fa-check"></i><b>2.4.4</b> Several Random Variables</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="probability-review.html"><a href="probability-review.html#expectations"><i class="fa fa-check"></i><b>2.5</b> Expectations</a></li>
<li class="chapter" data-level="2.6" data-path="probability-review.html"><a href="probability-review.html#likelihood"><i class="fa fa-check"></i><b>2.6</b> Likelihood</a></li>
<li class="chapter" data-level="2.7" data-path="probability-review.html"><a href="probability-review.html#videos"><i class="fa fa-check"></i><b>2.7</b> Videos</a></li>
<li class="chapter" data-level="2.8" data-path="probability-review.html"><a href="probability-review.html#references"><i class="fa fa-check"></i><b>2.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r-rstudio-rmarkdown.html"><a href="r-rstudio-rmarkdown.html"><i class="fa fa-check"></i><b>3</b> <code>R</code>, RStudio, RMarkdown</a><ul>
<li class="chapter" data-level="3.1" data-path="r-rstudio-rmarkdown.html"><a href="r-rstudio-rmarkdown.html#videos-1"><i class="fa fa-check"></i><b>3.1</b> Videos</a></li>
<li class="chapter" data-level="3.2" data-path="r-rstudio-rmarkdown.html"><a href="r-rstudio-rmarkdown.html#template"><i class="fa fa-check"></i><b>3.2</b> Template</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="modeling-basics-in-r.html"><a href="modeling-basics-in-r.html"><i class="fa fa-check"></i><b>4</b> Modeling Basics in <code>R</code></a><ul>
<li class="chapter" data-level="4.1" data-path="modeling-basics-in-r.html"><a href="modeling-basics-in-r.html#visualization-for-regression"><i class="fa fa-check"></i><b>4.1</b> Visualization for Regression</a></li>
<li class="chapter" data-level="4.2" data-path="modeling-basics-in-r.html"><a href="modeling-basics-in-r.html#the-lm-function"><i class="fa fa-check"></i><b>4.2</b> The <code>lm()</code> Function</a></li>
<li class="chapter" data-level="4.3" data-path="modeling-basics-in-r.html"><a href="modeling-basics-in-r.html#hypothesis-testing"><i class="fa fa-check"></i><b>4.3</b> Hypothesis Testing</a></li>
<li class="chapter" data-level="4.4" data-path="modeling-basics-in-r.html"><a href="modeling-basics-in-r.html#prediction"><i class="fa fa-check"></i><b>4.4</b> Prediction</a></li>
<li class="chapter" data-level="4.5" data-path="modeling-basics-in-r.html"><a href="modeling-basics-in-r.html#unusual-observations"><i class="fa fa-check"></i><b>4.5</b> Unusual Observations</a></li>
<li class="chapter" data-level="4.6" data-path="modeling-basics-in-r.html"><a href="modeling-basics-in-r.html#adding-complexity"><i class="fa fa-check"></i><b>4.6</b> Adding Complexity</a><ul>
<li class="chapter" data-level="4.6.1" data-path="modeling-basics-in-r.html"><a href="modeling-basics-in-r.html#interactions"><i class="fa fa-check"></i><b>4.6.1</b> Interactions</a></li>
<li class="chapter" data-level="4.6.2" data-path="modeling-basics-in-r.html"><a href="modeling-basics-in-r.html#polynomials"><i class="fa fa-check"></i><b>4.6.2</b> Polynomials</a></li>
<li class="chapter" data-level="4.6.3" data-path="modeling-basics-in-r.html"><a href="modeling-basics-in-r.html#transformations"><i class="fa fa-check"></i><b>4.6.3</b> Transformations</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="modeling-basics-in-r.html"><a href="modeling-basics-in-r.html#rmarkdown"><i class="fa fa-check"></i><b>4.7</b> <code>rmarkdown</code></a></li>
</ul></li>
<li class="part"><span><b>II Regression</b></span></li>
<li class="chapter" data-level="5" data-path="regression-overview.html"><a href="regression-overview.html"><i class="fa fa-check"></i><b>5</b> Overview</a><ul>
<li class="chapter" data-level="5.1" data-path="regression-overview.html"><a href="regression-overview.html#assesing-model-accuracy"><i class="fa fa-check"></i><b>5.1</b> Assesing Model Accuracy</a></li>
<li class="chapter" data-level="5.2" data-path="regression-overview.html"><a href="regression-overview.html#model-complexity"><i class="fa fa-check"></i><b>5.2</b> Model Complexity</a></li>
<li class="chapter" data-level="5.3" data-path="regression-overview.html"><a href="regression-overview.html#test-train-split"><i class="fa fa-check"></i><b>5.3</b> Test-Train Split</a></li>
<li class="chapter" data-level="5.4" data-path="regression-overview.html"><a href="regression-overview.html#adding-flexibility-to-linear-models"><i class="fa fa-check"></i><b>5.4</b> Adding Flexibility to Linear Models</a></li>
<li class="chapter" data-level="5.5" data-path="regression-overview.html"><a href="regression-overview.html#choosing-a-model"><i class="fa fa-check"></i><b>5.5</b> Choosing a Model</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="linear-models.html"><a href="linear-models.html"><i class="fa fa-check"></i><b>6</b> Linear Models</a></li>
<li class="chapter" data-level="7" data-path="knn-reg.html"><a href="knn-reg.html"><i class="fa fa-check"></i><b>7</b> k-Nearest Neighbors</a></li>
<li class="chapter" data-level="8" data-path="simulating-the-biasvariance-tradeoff.html"><a href="simulating-the-biasvariance-tradeoff.html"><i class="fa fa-check"></i><b>8</b> Simulating the Biasâ€“Variance Tradeoff</a><ul>
<li class="chapter" data-level="8.1" data-path="simulating-the-biasvariance-tradeoff.html"><a href="simulating-the-biasvariance-tradeoff.html#bias-variance-decomposition"><i class="fa fa-check"></i><b>8.1</b> Bias-Variance Decomposition</a></li>
<li class="chapter" data-level="8.2" data-path="simulating-the-biasvariance-tradeoff.html"><a href="simulating-the-biasvariance-tradeoff.html#simulation"><i class="fa fa-check"></i><b>8.2</b> Simulation</a></li>
<li class="chapter" data-level="8.3" data-path="simulating-the-biasvariance-tradeoff.html"><a href="simulating-the-biasvariance-tradeoff.html#bias-variance-tradeoff"><i class="fa fa-check"></i><b>8.3</b> Bias-Variance Tradeoff</a></li>
</ul></li>
<li class="part"><span><b>III Classification</b></span></li>
<li class="chapter" data-level="9" data-path="classification-overview.html"><a href="classification-overview.html"><i class="fa fa-check"></i><b>9</b> Overview</a><ul>
<li class="chapter" data-level="9.1" data-path="classification-overview.html"><a href="classification-overview.html#visualization-for-classification"><i class="fa fa-check"></i><b>9.1</b> Visualization for Classification</a></li>
<li class="chapter" data-level="9.2" data-path="classification-overview.html"><a href="classification-overview.html#a-simple-classifier"><i class="fa fa-check"></i><b>9.2</b> A Simple Classifier</a></li>
<li class="chapter" data-level="9.3" data-path="classification-overview.html"><a href="classification-overview.html#metrics-for-classification"><i class="fa fa-check"></i><b>9.3</b> Metrics for Classification</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>10</b> Logistic Regression</a><ul>
<li class="chapter" data-level="10.1" data-path="logistic-regression.html"><a href="logistic-regression.html#linear-regression"><i class="fa fa-check"></i><b>10.1</b> Linear Regression</a></li>
<li class="chapter" data-level="10.2" data-path="logistic-regression.html"><a href="logistic-regression.html#bayes-classifier"><i class="fa fa-check"></i><b>10.2</b> Bayes Classifier</a></li>
<li class="chapter" data-level="10.3" data-path="logistic-regression.html"><a href="logistic-regression.html#logistic-regression-with-glm"><i class="fa fa-check"></i><b>10.3</b> Logistic Regression with <code>glm()</code></a></li>
<li class="chapter" data-level="10.4" data-path="logistic-regression.html"><a href="logistic-regression.html#roc-curves"><i class="fa fa-check"></i><b>10.4</b> ROC Curves</a></li>
<li class="chapter" data-level="10.5" data-path="logistic-regression.html"><a href="logistic-regression.html#multinomial-logistic-regression"><i class="fa fa-check"></i><b>10.5</b> Multinomial Logistic Regression</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="generative-models.html"><a href="generative-models.html"><i class="fa fa-check"></i><b>11</b> Generative Models</a><ul>
<li class="chapter" data-level="11.1" data-path="generative-models.html"><a href="generative-models.html#linear-discriminant-analysis"><i class="fa fa-check"></i><b>11.1</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="11.2" data-path="generative-models.html"><a href="generative-models.html#quadratic-discriminant-analysis"><i class="fa fa-check"></i><b>11.2</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="11.3" data-path="generative-models.html"><a href="generative-models.html#naive-bayes"><i class="fa fa-check"></i><b>11.3</b> Naive Bayes</a></li>
<li class="chapter" data-level="11.4" data-path="generative-models.html"><a href="generative-models.html#discrete-inputs"><i class="fa fa-check"></i><b>11.4</b> Discrete Inputs</a></li>
<li class="chapter" data-level="11.5" data-path="generative-models.html"><a href="generative-models.html#rmarkdown-1"><i class="fa fa-check"></i><b>11.5</b> RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="knn-class.html"><a href="knn-class.html"><i class="fa fa-check"></i><b>12</b> k-Nearest Neighbors</a><ul>
<li class="chapter" data-level="12.1" data-path="knn-class.html"><a href="knn-class.html#classification"><i class="fa fa-check"></i><b>12.1</b> Classification</a><ul>
<li class="chapter" data-level="12.1.1" data-path="knn-class.html"><a href="knn-class.html#default-data"><i class="fa fa-check"></i><b>12.1.1</b> Default Data</a></li>
<li class="chapter" data-level="12.1.2" data-path="knn-class.html"><a href="knn-class.html#iris-data"><i class="fa fa-check"></i><b>12.1.2</b> Iris Data</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="knn-class.html"><a href="knn-class.html#regression"><i class="fa fa-check"></i><b>12.2</b> Regression</a></li>
<li class="chapter" data-level="12.3" data-path="knn-class.html"><a href="knn-class.html#external-links"><i class="fa fa-check"></i><b>12.3</b> External Links</a></li>
<li class="chapter" data-level="12.4" data-path="knn-class.html"><a href="knn-class.html#rmarkdown-2"><i class="fa fa-check"></i><b>12.4</b> RMarkdown</a></li>
</ul></li>
<li class="part"><span><b>IV Unsupervised Learning</b></span></li>
<li class="chapter" data-level="13" data-path="unsupervised-overview.html"><a href="unsupervised-overview.html"><i class="fa fa-check"></i><b>13</b> Overview</a><ul>
<li class="chapter" data-level="13.1" data-path="unsupervised-overview.html"><a href="unsupervised-overview.html#methods"><i class="fa fa-check"></i><b>13.1</b> Methods</a><ul>
<li class="chapter" data-level="13.1.1" data-path="unsupervised-overview.html"><a href="unsupervised-overview.html#principal-component-analysis"><i class="fa fa-check"></i><b>13.1.1</b> Principal Component Analysis</a></li>
<li class="chapter" data-level="13.1.2" data-path="unsupervised-overview.html"><a href="unsupervised-overview.html#k-means-clustering"><i class="fa fa-check"></i><b>13.1.2</b> <span class="math inline">\(k\)</span>-Means Clustering</a></li>
<li class="chapter" data-level="13.1.3" data-path="unsupervised-overview.html"><a href="unsupervised-overview.html#hierarchical-clustering"><i class="fa fa-check"></i><b>13.1.3</b> Hierarchical Clustering</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="unsupervised-overview.html"><a href="unsupervised-overview.html#examples"><i class="fa fa-check"></i><b>13.2</b> Examples</a><ul>
<li class="chapter" data-level="13.2.1" data-path="unsupervised-overview.html"><a href="unsupervised-overview.html#us-arrests"><i class="fa fa-check"></i><b>13.2.1</b> US Arrests</a></li>
<li class="chapter" data-level="13.2.2" data-path="unsupervised-overview.html"><a href="unsupervised-overview.html#simulated-data"><i class="fa fa-check"></i><b>13.2.2</b> Simulated Data</a></li>
<li class="chapter" data-level="13.2.3" data-path="unsupervised-overview.html"><a href="unsupervised-overview.html#iris-data-1"><i class="fa fa-check"></i><b>13.2.3</b> Iris Data</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="unsupervised-overview.html"><a href="unsupervised-overview.html#external-links-1"><i class="fa fa-check"></i><b>13.3</b> External Links</a></li>
<li class="chapter" data-level="13.4" data-path="unsupervised-overview.html"><a href="unsupervised-overview.html#rmarkdown-3"><i class="fa fa-check"></i><b>13.4</b> RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="principal-component-analysis-1.html"><a href="principal-component-analysis-1.html"><i class="fa fa-check"></i><b>14</b> Principal Component Analysis</a></li>
<li class="chapter" data-level="15" data-path="k-means.html"><a href="k-means.html"><i class="fa fa-check"></i><b>15</b> k-Means</a></li>
<li class="chapter" data-level="16" data-path="mixture-models.html"><a href="mixture-models.html"><i class="fa fa-check"></i><b>16</b> Mixture Models</a></li>
<li class="chapter" data-level="17" data-path="hierarchical-clustering-1.html"><a href="hierarchical-clustering-1.html"><i class="fa fa-check"></i><b>17</b> Hierarchical Clustering</a></li>
<li class="part"><span><b>V In Practice</b></span></li>
<li class="chapter" data-level="18" data-path="practice-overview.html"><a href="practice-overview.html"><i class="fa fa-check"></i><b>18</b> Overview</a></li>
<li class="chapter" data-level="19" data-path="supervised-learning-overview.html"><a href="supervised-learning-overview.html"><i class="fa fa-check"></i><b>19</b> Supervised Learning Overview</a><ul>
<li class="chapter" data-level="" data-path="supervised-learning-overview.html"><a href="supervised-learning-overview.html#bayes-classifier-1"><i class="fa fa-check"></i>Bayes Classifier</a></li>
<li class="chapter" data-level="" data-path="supervised-learning-overview.html"><a href="supervised-learning-overview.html#the-bias-variance-tradeoff"><i class="fa fa-check"></i>The Bias-Variance Tradeoff</a></li>
<li class="chapter" data-level="" data-path="supervised-learning-overview.html"><a href="supervised-learning-overview.html#the-test-train-split"><i class="fa fa-check"></i>The Test-Train Split</a></li>
<li class="chapter" data-level="" data-path="supervised-learning-overview.html"><a href="supervised-learning-overview.html#classification-methods"><i class="fa fa-check"></i>Classification Methods</a></li>
<li class="chapter" data-level="" data-path="supervised-learning-overview.html"><a href="supervised-learning-overview.html#discriminative-versus-generative-methods"><i class="fa fa-check"></i>Discriminative versus Generative Methods</a></li>
<li class="chapter" data-level="" data-path="supervised-learning-overview.html"><a href="supervised-learning-overview.html#parametric-and-non-parametric-methods"><i class="fa fa-check"></i>Parametric and Non-Parametric Methods</a></li>
<li class="chapter" data-level="" data-path="supervised-learning-overview.html"><a href="supervised-learning-overview.html#tuning-parameters"><i class="fa fa-check"></i>Tuning Parameters</a></li>
<li class="chapter" data-level="" data-path="supervised-learning-overview.html"><a href="supervised-learning-overview.html#cross-validation"><i class="fa fa-check"></i>Cross-Validation</a></li>
<li class="chapter" data-level="" data-path="supervised-learning-overview.html"><a href="supervised-learning-overview.html#curse-of-dimensionality"><i class="fa fa-check"></i>Curse of Dimensionality</a></li>
<li class="chapter" data-level="" data-path="supervised-learning-overview.html"><a href="supervised-learning-overview.html#no-free-lunch-theorem"><i class="fa fa-check"></i>No-Free-Lunch Theorem</a></li>
<li class="chapter" data-level="19.1" data-path="supervised-learning-overview.html"><a href="supervised-learning-overview.html#external-links-2"><i class="fa fa-check"></i><b>19.1</b> External Links</a></li>
<li class="chapter" data-level="19.2" data-path="supervised-learning-overview.html"><a href="supervised-learning-overview.html#rmarkdown-4"><i class="fa fa-check"></i><b>19.2</b> RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="resampling.html"><a href="resampling.html"><i class="fa fa-check"></i><b>20</b> Resampling</a><ul>
<li class="chapter" data-level="20.1" data-path="resampling.html"><a href="resampling.html#test-train-split-1"><i class="fa fa-check"></i><b>20.1</b> Test-Train Split</a></li>
<li class="chapter" data-level="20.2" data-path="resampling.html"><a href="resampling.html#cross-validation-1"><i class="fa fa-check"></i><b>20.2</b> Cross-Validation</a><ul>
<li class="chapter" data-level="20.2.1" data-path="resampling.html"><a href="resampling.html#method-specific"><i class="fa fa-check"></i><b>20.2.1</b> Method Specific</a></li>
<li class="chapter" data-level="20.2.2" data-path="resampling.html"><a href="resampling.html#manual-cross-validation"><i class="fa fa-check"></i><b>20.2.2</b> Manual Cross-Validation</a></li>
<li class="chapter" data-level="20.2.3" data-path="resampling.html"><a href="resampling.html#test-data"><i class="fa fa-check"></i><b>20.2.3</b> Test Data</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="resampling.html"><a href="resampling.html#bootstrap"><i class="fa fa-check"></i><b>20.3</b> Bootstrap</a></li>
<li class="chapter" data-level="20.4" data-path="resampling.html"><a href="resampling.html#external-links-3"><i class="fa fa-check"></i><b>20.4</b> External Links</a></li>
<li class="chapter" data-level="20.5" data-path="resampling.html"><a href="resampling.html#rmarkdown-5"><i class="fa fa-check"></i><b>20.5</b> RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="the-caret-package.html"><a href="the-caret-package.html"><i class="fa fa-check"></i><b>21</b> The <code>caret</code> Package</a><ul>
<li class="chapter" data-level="21.1" data-path="the-caret-package.html"><a href="the-caret-package.html#external-links-4"><i class="fa fa-check"></i><b>21.1</b> External Links</a></li>
<li class="chapter" data-level="21.2" data-path="the-caret-package.html"><a href="the-caret-package.html#rmarkdown-6"><i class="fa fa-check"></i><b>21.2</b> RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="subset-selection.html"><a href="subset-selection.html"><i class="fa fa-check"></i><b>22</b> Subset Selection</a><ul>
<li class="chapter" data-level="22.1" data-path="subset-selection.html"><a href="subset-selection.html#aic-bic-and-cp"><i class="fa fa-check"></i><b>22.1</b> AIC, BIC, and Cp</a><ul>
<li class="chapter" data-level="22.1.1" data-path="subset-selection.html"><a href="subset-selection.html#leaps-package"><i class="fa fa-check"></i><b>22.1.1</b> <code>leaps</code> Package</a></li>
<li class="chapter" data-level="22.1.2" data-path="subset-selection.html"><a href="subset-selection.html#best-subset"><i class="fa fa-check"></i><b>22.1.2</b> Best Subset</a></li>
<li class="chapter" data-level="22.1.3" data-path="subset-selection.html"><a href="subset-selection.html#stepwise-methods"><i class="fa fa-check"></i><b>22.1.3</b> Stepwise Methods</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="subset-selection.html"><a href="subset-selection.html#validated-rmse"><i class="fa fa-check"></i><b>22.2</b> Validated RMSE</a></li>
<li class="chapter" data-level="22.3" data-path="subset-selection.html"><a href="subset-selection.html#external-links-5"><i class="fa fa-check"></i><b>22.3</b> External Links</a></li>
<li class="chapter" data-level="22.4" data-path="subset-selection.html"><a href="subset-selection.html#rmarkdown-7"><i class="fa fa-check"></i><b>22.4</b> RMarkdown</a></li>
</ul></li>
<li class="part"><span><b>VI The Modern Era</b></span></li>
<li class="chapter" data-level="23" data-path="modern-overview.html"><a href="modern-overview.html"><i class="fa fa-check"></i><b>23</b> Overview</a></li>
<li class="chapter" data-level="24" data-path="regularization.html"><a href="regularization.html"><i class="fa fa-check"></i><b>24</b> Regularization</a><ul>
<li class="chapter" data-level="24.1" data-path="regularization.html"><a href="regularization.html#ridge-regression"><i class="fa fa-check"></i><b>24.1</b> Ridge Regression</a></li>
<li class="chapter" data-level="24.2" data-path="regularization.html"><a href="regularization.html#lasso"><i class="fa fa-check"></i><b>24.2</b> Lasso</a></li>
<li class="chapter" data-level="24.3" data-path="regularization.html"><a href="regularization.html#broom"><i class="fa fa-check"></i><b>24.3</b> <code>broom</code></a></li>
<li class="chapter" data-level="24.4" data-path="regularization.html"><a href="regularization.html#simulation-study-p-n"><i class="fa fa-check"></i><b>24.4</b> Simulation Study, p &gt; n</a></li>
<li class="chapter" data-level="24.5" data-path="regularization.html"><a href="regularization.html#external-links-6"><i class="fa fa-check"></i><b>24.5</b> External Links</a></li>
<li class="chapter" data-level="24.6" data-path="regularization.html"><a href="regularization.html#rmarkdown-8"><i class="fa fa-check"></i><b>24.6</b> RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="elastic-net.html"><a href="elastic-net.html"><i class="fa fa-check"></i><b>25</b> Elastic Net</a><ul>
<li class="chapter" data-level="25.1" data-path="elastic-net.html"><a href="elastic-net.html#hitters-data"><i class="fa fa-check"></i><b>25.1</b> Hitters Data</a></li>
<li class="chapter" data-level="25.2" data-path="elastic-net.html"><a href="elastic-net.html#elastic-net-for-regression"><i class="fa fa-check"></i><b>25.2</b> Elastic Net for Regression</a></li>
<li class="chapter" data-level="25.3" data-path="elastic-net.html"><a href="elastic-net.html#elastic-net-for-classification"><i class="fa fa-check"></i><b>25.3</b> Elastic Net for Classification</a></li>
<li class="chapter" data-level="25.4" data-path="elastic-net.html"><a href="elastic-net.html#external-links-7"><i class="fa fa-check"></i><b>25.4</b> External Links</a></li>
<li class="chapter" data-level="25.5" data-path="elastic-net.html"><a href="elastic-net.html#rmarkdown-9"><i class="fa fa-check"></i><b>25.5</b> RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="trees.html"><a href="trees.html"><i class="fa fa-check"></i><b>26</b> Trees</a><ul>
<li class="chapter" data-level="26.1" data-path="trees.html"><a href="trees.html#classification-trees"><i class="fa fa-check"></i><b>26.1</b> Classification Trees</a></li>
<li class="chapter" data-level="26.2" data-path="trees.html"><a href="trees.html#regression-trees"><i class="fa fa-check"></i><b>26.2</b> Regression Trees</a></li>
<li class="chapter" data-level="26.3" data-path="trees.html"><a href="trees.html#rpart-package"><i class="fa fa-check"></i><b>26.3</b> <code>rpart</code> Package</a></li>
<li class="chapter" data-level="26.4" data-path="trees.html"><a href="trees.html#external-links-8"><i class="fa fa-check"></i><b>26.4</b> External Links</a></li>
<li class="chapter" data-level="26.5" data-path="trees.html"><a href="trees.html#rmarkdown-10"><i class="fa fa-check"></i><b>26.5</b> RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="ensemble-methods.html"><a href="ensemble-methods.html"><i class="fa fa-check"></i><b>27</b> Ensemble Methods</a><ul>
<li class="chapter" data-level="27.1" data-path="ensemble-methods.html"><a href="ensemble-methods.html#regression-1"><i class="fa fa-check"></i><b>27.1</b> Regression</a><ul>
<li class="chapter" data-level="27.1.1" data-path="ensemble-methods.html"><a href="ensemble-methods.html#tree-model"><i class="fa fa-check"></i><b>27.1.1</b> Tree Model</a></li>
<li class="chapter" data-level="27.1.2" data-path="ensemble-methods.html"><a href="ensemble-methods.html#linear-model"><i class="fa fa-check"></i><b>27.1.2</b> Linear Model</a></li>
<li class="chapter" data-level="27.1.3" data-path="ensemble-methods.html"><a href="ensemble-methods.html#bagging"><i class="fa fa-check"></i><b>27.1.3</b> Bagging</a></li>
<li class="chapter" data-level="27.1.4" data-path="ensemble-methods.html"><a href="ensemble-methods.html#random-forest"><i class="fa fa-check"></i><b>27.1.4</b> Random Forest</a></li>
<li class="chapter" data-level="27.1.5" data-path="ensemble-methods.html"><a href="ensemble-methods.html#boosting"><i class="fa fa-check"></i><b>27.1.5</b> Boosting</a></li>
<li class="chapter" data-level="27.1.6" data-path="ensemble-methods.html"><a href="ensemble-methods.html#results"><i class="fa fa-check"></i><b>27.1.6</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="27.2" data-path="ensemble-methods.html"><a href="ensemble-methods.html#classification-1"><i class="fa fa-check"></i><b>27.2</b> Classification</a><ul>
<li class="chapter" data-level="27.2.1" data-path="ensemble-methods.html"><a href="ensemble-methods.html#tree-model-1"><i class="fa fa-check"></i><b>27.2.1</b> Tree Model</a></li>
<li class="chapter" data-level="27.2.2" data-path="ensemble-methods.html"><a href="ensemble-methods.html#logistic-regression-1"><i class="fa fa-check"></i><b>27.2.2</b> Logistic Regression</a></li>
<li class="chapter" data-level="27.2.3" data-path="ensemble-methods.html"><a href="ensemble-methods.html#bagging-1"><i class="fa fa-check"></i><b>27.2.3</b> Bagging</a></li>
<li class="chapter" data-level="27.2.4" data-path="ensemble-methods.html"><a href="ensemble-methods.html#random-forest-1"><i class="fa fa-check"></i><b>27.2.4</b> Random Forest</a></li>
<li class="chapter" data-level="27.2.5" data-path="ensemble-methods.html"><a href="ensemble-methods.html#boosting-1"><i class="fa fa-check"></i><b>27.2.5</b> Boosting</a></li>
<li class="chapter" data-level="27.2.6" data-path="ensemble-methods.html"><a href="ensemble-methods.html#results-1"><i class="fa fa-check"></i><b>27.2.6</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="27.3" data-path="ensemble-methods.html"><a href="ensemble-methods.html#tuning"><i class="fa fa-check"></i><b>27.3</b> Tuning</a><ul>
<li class="chapter" data-level="27.3.1" data-path="ensemble-methods.html"><a href="ensemble-methods.html#random-forest-and-bagging"><i class="fa fa-check"></i><b>27.3.1</b> Random Forest and Bagging</a></li>
<li class="chapter" data-level="27.3.2" data-path="ensemble-methods.html"><a href="ensemble-methods.html#boosting-2"><i class="fa fa-check"></i><b>27.3.2</b> Boosting</a></li>
</ul></li>
<li class="chapter" data-level="27.4" data-path="ensemble-methods.html"><a href="ensemble-methods.html#tree-versus-ensemble-boundaries"><i class="fa fa-check"></i><b>27.4</b> Tree versus Ensemble Boundaries</a></li>
<li class="chapter" data-level="27.5" data-path="ensemble-methods.html"><a href="ensemble-methods.html#external-links-9"><i class="fa fa-check"></i><b>27.5</b> External Links</a></li>
<li class="chapter" data-level="27.6" data-path="ensemble-methods.html"><a href="ensemble-methods.html#rmarkdown-11"><i class="fa fa-check"></i><b>27.6</b> RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="artificial-neural-networks.html"><a href="artificial-neural-networks.html"><i class="fa fa-check"></i><b>28</b> Artificial Neural Networks</a></li>
<li class="part"><span><b>VII Appendix</b></span></li>
<li class="chapter" data-level="29" data-path="appendix-overview.html"><a href="appendix-overview.html"><i class="fa fa-check"></i><b>29</b> Overview</a></li>
<li class="chapter" data-level="30" data-path="non-linear-models.html"><a href="non-linear-models.html"><i class="fa fa-check"></i><b>30</b> Non-Linear Models</a><ul>
<li class="chapter" data-level="30.1" data-path="non-linear-models.html"><a href="non-linear-models.html#polynomial-regression"><i class="fa fa-check"></i><b>30.1</b> Polynomial Regression</a><ul>
<li class="chapter" data-level="30.1.1" data-path="non-linear-models.html"><a href="non-linear-models.html#anova"><i class="fa fa-check"></i><b>30.1.1</b> ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="30.2" data-path="non-linear-models.html"><a href="non-linear-models.html#logistic-regression-polynomial-terms"><i class="fa fa-check"></i><b>30.2</b> Logistic Regression, Polynomial Terms</a></li>
<li class="chapter" data-level="30.3" data-path="non-linear-models.html"><a href="non-linear-models.html#step-functions"><i class="fa fa-check"></i><b>30.3</b> Step Functions</a><ul>
<li class="chapter" data-level="30.3.1" data-path="non-linear-models.html"><a href="non-linear-models.html#smoothing-splines"><i class="fa fa-check"></i><b>30.3.1</b> Smoothing Splines</a></li>
</ul></li>
<li class="chapter" data-level="30.4" data-path="non-linear-models.html"><a href="non-linear-models.html#local-regression"><i class="fa fa-check"></i><b>30.4</b> Local Regression</a></li>
<li class="chapter" data-level="30.5" data-path="non-linear-models.html"><a href="non-linear-models.html#generalized-additive-models-gams"><i class="fa fa-check"></i><b>30.5</b> Generalized Additive Models (GAMs)</a><ul>
<li class="chapter" data-level="30.5.1" data-path="non-linear-models.html"><a href="non-linear-models.html#gams-in-caret"><i class="fa fa-check"></i><b>30.5.1</b> GAMs in <code>caret</code></a></li>
</ul></li>
<li class="chapter" data-level="30.6" data-path="non-linear-models.html"><a href="non-linear-models.html#external-links-10"><i class="fa fa-check"></i><b>30.6</b> External Links</a></li>
<li class="chapter" data-level="30.7" data-path="non-linear-models.html"><a href="non-linear-models.html#rmarkdown-12"><i class="fa fa-check"></i><b>30.7</b> RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="regularized-discriminant-analysis.html"><a href="regularized-discriminant-analysis.html"><i class="fa fa-check"></i><b>31</b> Regularized Discriminant Analysis</a><ul>
<li class="chapter" data-level="31.1" data-path="regularized-discriminant-analysis.html"><a href="regularized-discriminant-analysis.html#sonar-data"><i class="fa fa-check"></i><b>31.1</b> Sonar Data</a></li>
<li class="chapter" data-level="31.2" data-path="regularized-discriminant-analysis.html"><a href="regularized-discriminant-analysis.html#rda"><i class="fa fa-check"></i><b>31.2</b> RDA</a></li>
<li class="chapter" data-level="31.3" data-path="regularized-discriminant-analysis.html"><a href="regularized-discriminant-analysis.html#rda-with-grid-search"><i class="fa fa-check"></i><b>31.3</b> RDA with Grid Search</a></li>
<li class="chapter" data-level="31.4" data-path="regularized-discriminant-analysis.html"><a href="regularized-discriminant-analysis.html#rda-with-random-search-search"><i class="fa fa-check"></i><b>31.4</b> RDA with Random Search Search</a></li>
<li class="chapter" data-level="31.5" data-path="regularized-discriminant-analysis.html"><a href="regularized-discriminant-analysis.html#comparison-to-elastic-net"><i class="fa fa-check"></i><b>31.5</b> Comparison to Elastic Net</a></li>
<li class="chapter" data-level="31.6" data-path="regularized-discriminant-analysis.html"><a href="regularized-discriminant-analysis.html#results-2"><i class="fa fa-check"></i><b>31.6</b> Results</a></li>
<li class="chapter" data-level="31.7" data-path="regularized-discriminant-analysis.html"><a href="regularized-discriminant-analysis.html#external-links-11"><i class="fa fa-check"></i><b>31.7</b> External Links</a></li>
<li class="chapter" data-level="31.8" data-path="regularized-discriminant-analysis.html"><a href="regularized-discriminant-analysis.html#rmarkdown-13"><i class="fa fa-check"></i><b>31.8</b> RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="support-vector-machines.html"><a href="support-vector-machines.html"><i class="fa fa-check"></i><b>32</b> Support Vector Machines</a><ul>
<li class="chapter" data-level="32.1" data-path="support-vector-machines.html"><a href="support-vector-machines.html#r-packages"><i class="fa fa-check"></i><b>32.1</b> <code>R</code> Packages</a></li>
<li class="chapter" data-level="32.2" data-path="support-vector-machines.html"><a href="support-vector-machines.html#classification-2"><i class="fa fa-check"></i><b>32.2</b> Classification</a></li>
<li class="chapter" data-level="32.3" data-path="support-vector-machines.html"><a href="support-vector-machines.html#linear-separable-example"><i class="fa fa-check"></i><b>32.3</b> Linear, Separable Example</a><ul>
<li class="chapter" data-level="32.3.1" data-path="support-vector-machines.html"><a href="support-vector-machines.html#data-simulation"><i class="fa fa-check"></i><b>32.3.1</b> Data Simulation</a></li>
<li class="chapter" data-level="32.3.2" data-path="support-vector-machines.html"><a href="support-vector-machines.html#linear-kernel-parameter-c"><i class="fa fa-check"></i><b>32.3.2</b> Linear Kernel, Parameter <code>C</code></a></li>
<li class="chapter" data-level="32.3.3" data-path="support-vector-machines.html"><a href="support-vector-machines.html#radial-kernel"><i class="fa fa-check"></i><b>32.3.3</b> Radial Kernel</a></li>
<li class="chapter" data-level="32.3.4" data-path="support-vector-machines.html"><a href="support-vector-machines.html#tuning-with-caret"><i class="fa fa-check"></i><b>32.3.4</b> Tuning with <code>caret</code></a></li>
<li class="chapter" data-level="32.3.5" data-path="support-vector-machines.html"><a href="support-vector-machines.html#compare-random-forest"><i class="fa fa-check"></i><b>32.3.5</b> Compare: Random Forest</a></li>
</ul></li>
<li class="chapter" data-level="32.4" data-path="support-vector-machines.html"><a href="support-vector-machines.html#non-linear-non-separable-example"><i class="fa fa-check"></i><b>32.4</b> Non-Linear, Non-Separable Example</a><ul>
<li class="chapter" data-level="32.4.1" data-path="support-vector-machines.html"><a href="support-vector-machines.html#data-simulation-1"><i class="fa fa-check"></i><b>32.4.1</b> Data Simulation</a></li>
<li class="chapter" data-level="32.4.2" data-path="support-vector-machines.html"><a href="support-vector-machines.html#radial-kernel-parameter-c"><i class="fa fa-check"></i><b>32.4.2</b> Radial Kernel, Parameter <code>C</code></a></li>
<li class="chapter" data-level="32.4.3" data-path="support-vector-machines.html"><a href="support-vector-machines.html#radial-kernel-parameter-sigma"><i class="fa fa-check"></i><b>32.4.3</b> Radial Kernel, Parameter <code>sigma</code></a></li>
<li class="chapter" data-level="32.4.4" data-path="support-vector-machines.html"><a href="support-vector-machines.html#radial-kernel-tuning"><i class="fa fa-check"></i><b>32.4.4</b> Radial Kernel, Tuning</a></li>
<li class="chapter" data-level="32.4.5" data-path="support-vector-machines.html"><a href="support-vector-machines.html#polynomial-kernel-tuning"><i class="fa fa-check"></i><b>32.4.5</b> Polynomial Kernel, Tuning</a></li>
<li class="chapter" data-level="32.4.6" data-path="support-vector-machines.html"><a href="support-vector-machines.html#linear-kernel-tuning"><i class="fa fa-check"></i><b>32.4.6</b> Linear Kernel, Tuning</a></li>
<li class="chapter" data-level="32.4.7" data-path="support-vector-machines.html"><a href="support-vector-machines.html#compare-random-forest-1"><i class="fa fa-check"></i><b>32.4.7</b> Compare: Random Forest</a></li>
</ul></li>
<li class="chapter" data-level="32.5" data-path="support-vector-machines.html"><a href="support-vector-machines.html#external-links-12"><i class="fa fa-check"></i><b>32.5</b> External Links</a></li>
<li class="chapter" data-level="32.6" data-path="support-vector-machines.html"><a href="support-vector-machines.html#rmarkdown-14"><i class="fa fa-check"></i><b>32.6</b> RMarkdown</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/daviddalpiaz/r4sl" target="blank">&copy; 2017 David Dalpiaz</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><code>R</code> for Statistical Learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="support-vector-machines" class="section level1">
<h1><span class="header-section-number">Chapter 32</span> Support Vector Machines</h1>
<div id="r-packages" class="section level2">
<h2><span class="header-section-number">32.1</span> <code>R</code> Packages</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(randomForest)
<span class="kw">library</span>(caret)
<span class="kw">library</span>(kernlab)</code></pre></div>
<p>For working with SVMs in <code>R</code> we will use the <a href="https://cran.r-project.org/web/packages/kernlab/vignettes/kernlab.pdf">kernlab package</a> instead of <code>e1071</code>. For examples of <code>e1071</code> see the relevant chapter in ISL. We do not discuss the details of the method, however show how the method can be tuned.</p>
</div>
<div id="classification-2" class="section level2">
<h2><span class="header-section-number">32.2</span> Classification</h2>
<p>SVMs are mostly used for classification. Note that they can be modified for regression but we will not do that here. Since we are performing classification, we will use accuracy as our metric.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">accuracy =<span class="st"> </span>function(actual, predicted) {
  <span class="kw">mean</span>(actual ==<span class="st"> </span>predicted)
}</code></pre></div>
</div>
<div id="linear-separable-example" class="section level2">
<h2><span class="header-section-number">32.3</span> Linear, Separable Example</h2>
<div id="data-simulation" class="section level3">
<h3><span class="header-section-number">32.3.1</span> Data Simulation</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim_sep =<span class="st"> </span>function(<span class="dt">n =</span> <span class="dv">1000</span>) {
  x1 =<span class="st"> </span><span class="kw">runif</span>(n)
  x2 =<span class="st"> </span><span class="kw">runif</span>(n)
  keep =<span class="st"> </span>x1 +<span class="st"> </span><span class="fl">0.1</span> &lt;<span class="st"> </span>x2 |<span class="st"> </span>x1 -<span class="st"> </span><span class="fl">0.1</span> &gt;<span class="st"> </span>x2
  x1 =<span class="st"> </span>x1[keep]
  x2 =<span class="st"> </span>x2[keep] 
  y =<span class="st"> </span><span class="dv">1</span> *<span class="st"> </span>(x1 -<span class="st"> </span>x2 &gt;<span class="st"> </span><span class="dv">0</span>)
  y =<span class="st"> </span><span class="kw">ifelse</span>(y ==<span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;Orange&quot;</span>, <span class="st">&quot;Blue&quot;</span>)
  <span class="kw">data.frame</span>(<span class="dt">y =</span> <span class="kw">as.factor</span>(y), <span class="dt">x1 =</span> x1, <span class="dt">x2 =</span> x2)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">42</span>)
train_data =<span class="st"> </span><span class="kw">sim_sep</span>(<span class="dt">n =</span> <span class="dv">50</span>)
<span class="kw">plot</span>(x2 ~<span class="st"> </span>x1, <span class="dt">data =</span> train_data, <span class="dt">col =</span> <span class="kw">as.character</span>(y), <span class="dt">pch =</span> <span class="dv">19</span>)</code></pre></div>
<p><img src="32-svm_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">test_data =<span class="st"> </span><span class="kw">sim_sep</span>(<span class="dt">n =</span> <span class="dv">500</span>)
<span class="kw">str</span>(train_data)</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    41 obs. of  3 variables:
##  $ y : Factor w/ 2 levels &quot;Blue&quot;,&quot;Orange&quot;: 2 2 1 2 1 2 2 1 1 2 ...
##  $ x1: num  0.915 0.937 0.286 0.642 0.519 ...
##  $ x2: num  0.3334 0.3467 0.3985 0.0389 0.7488 ...</code></pre>
</div>
<div id="linear-kernel-parameter-c" class="section level3">
<h3><span class="header-section-number">32.3.2</span> Linear Kernel, Parameter <code>C</code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lin_svm_fit =<span class="st"> </span><span class="kw">ksvm</span>(y ~<span class="st"> </span>., <span class="dt">data =</span> train_data, <span class="dt">kernel =</span> <span class="st">&#39;vanilladot&#39;</span>, <span class="dt">C =</span> <span class="fl">0.1</span>)</code></pre></div>
<pre><code>##  Setting default kernel parameters</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(lin_svm_fit, <span class="dt">data =</span> train_data)</code></pre></div>
<p><img src="32-svm_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># train accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> train_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(lin_svm_fit, train_data))</code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># test accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> test_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(lin_svm_fit, test_data))</code></pre></div>
<pre><code>## [1] 0.9872449</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lin_svm_fit =<span class="st"> </span><span class="kw">ksvm</span>(y ~<span class="st"> </span>., <span class="dt">data =</span> train_data, <span class="dt">kernel =</span> <span class="st">&#39;vanilladot&#39;</span>, <span class="dt">C =</span> <span class="dv">1</span>)</code></pre></div>
<pre><code>##  Setting default kernel parameters</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(lin_svm_fit, <span class="dt">data =</span> train_data)</code></pre></div>
<p><img src="32-svm_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># train accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> train_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(lin_svm_fit, train_data))</code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># test accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> test_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(lin_svm_fit, test_data))</code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lin_svm_fit =<span class="st"> </span><span class="kw">ksvm</span>(y ~<span class="st"> </span>., <span class="dt">data =</span> train_data, <span class="dt">kernel =</span> <span class="st">&#39;vanilladot&#39;</span>, <span class="dt">C =</span> <span class="dv">10</span>)</code></pre></div>
<pre><code>##  Setting default kernel parameters</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(lin_svm_fit, <span class="dt">data =</span> train_data)</code></pre></div>
<p><img src="32-svm_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># train accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> train_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(lin_svm_fit, train_data))</code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># test accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> test_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(lin_svm_fit, test_data))</code></pre></div>
<pre><code>## [1] 1</code></pre>
</div>
<div id="radial-kernel" class="section level3">
<h3><span class="header-section-number">32.3.3</span> Radial Kernel</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">42</span>)
rad_svm_fit =<span class="st"> </span><span class="kw">ksvm</span>(y ~<span class="st"> </span>., <span class="dt">data =</span> train_data, <span class="dt">kernel =</span> <span class="st">&#39;rbfdot&#39;</span>, <span class="dt">C =</span> <span class="dv">1</span>)
<span class="kw">plot</span>(rad_svm_fit, <span class="dt">data =</span> train_data)</code></pre></div>
<p><img src="32-svm_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># train accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> train_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(rad_svm_fit, train_data))</code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># test accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> test_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(rad_svm_fit, test_data))</code></pre></div>
<pre><code>## [1] 1</code></pre>
</div>
<div id="tuning-with-caret" class="section level3">
<h3><span class="header-section-number">32.3.4</span> Tuning with <code>caret</code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">svm_grid =<span class="st">  </span><span class="kw">expand.grid</span>(<span class="dt">C =</span> <span class="kw">c</span>(<span class="dv">2</span> ^<span class="st"> </span>(-<span class="dv">5</span>:<span class="dv">5</span>)))
svm_control =<span class="st"> </span><span class="kw">trainControl</span>(<span class="dt">method =</span> <span class="st">&quot;cv&quot;</span>, <span class="dt">number =</span> <span class="dv">5</span>, 
                           <span class="dt">returnResamp =</span> <span class="st">&quot;all&quot;</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)

<span class="kw">set.seed</span>(<span class="dv">42</span>)
lin_svm_fit =<span class="st"> </span><span class="kw">train</span>(y ~<span class="st"> </span>., <span class="dt">data =</span> train_data, <span class="dt">method =</span> <span class="st">&quot;svmLinear&quot;</span>,
                    <span class="dt">trControl =</span> svm_control, <span class="dt">tuneGrid =</span> svm_grid)

lin_svm_fit</code></pre></div>
<pre><code>## Support Vector Machines with Linear Kernel 
## 
## 41 samples
##  2 predictor
##  2 classes: &#39;Blue&#39;, &#39;Orange&#39; 
## 
## No pre-processing
## Resampling: Cross-Validated (5 fold) 
## Summary of sample sizes: 33, 33, 33, 33, 32 
## Resampling results across tuning parameters:
## 
##   C         Accuracy  Kappa    
##    0.03125  0.850     0.6197802
##    0.06250  0.950     0.8928571
##    0.12500  0.975     0.9500000
##    0.25000  0.975     0.9500000
##    0.50000  0.975     0.9500000
##    1.00000  1.000     1.0000000
##    2.00000  0.975     0.9500000
##    4.00000  1.000     1.0000000
##    8.00000  1.000     1.0000000
##   16.00000  1.000     1.0000000
##   32.00000  1.000     1.0000000
## 
## Accuracy was used to select the optimal model using  the largest value.
## The final value used for the model was C = 1.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lin_svm_fit$bestTune</code></pre></div>
<pre><code>##   C
## 6 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># train accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> train_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(lin_svm_fit, train_data))</code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># test accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> test_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(lin_svm_fit, test_data))</code></pre></div>
<pre><code>## [1] 1</code></pre>
</div>
<div id="compare-random-forest" class="section level3">
<h3><span class="header-section-number">32.3.5</span> Compare: Random Forest</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">42</span>)
rf_grid =<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">mtry =</span> <span class="dv">1</span>:<span class="dv">2</span>)
rf_fit  =<span class="st"> </span><span class="kw">train</span>(y ~<span class="st"> </span>., <span class="dt">data =</span> train_data, <span class="dt">method =</span> <span class="st">&quot;rf&quot;</span>,
                <span class="dt">trControl =</span> svm_control, <span class="dt">tuneGrid =</span> rf_grid)
rf_fit$bestTune</code></pre></div>
<pre><code>##   mtry
## 1    1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># train accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> train_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(rf_fit, train_data))</code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># test accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> test_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(rf_fit, test_data))</code></pre></div>
<pre><code>## [1] 0.9591837</code></pre>
</div>
</div>
<div id="non-linear-non-separable-example" class="section level2">
<h2><span class="header-section-number">32.4</span> Non-Linear, Non-Separable Example</h2>
<div id="data-simulation-1" class="section level3">
<h3><span class="header-section-number">32.4.1</span> Data Simulation</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim_rad =<span class="st"> </span>function(<span class="dt">n =</span> <span class="dv">1000</span>) {
  x1 =<span class="st"> </span><span class="kw">runif</span>(n, -<span class="dv">1</span>, <span class="dv">1</span>)
  x2 =<span class="st"> </span><span class="kw">runif</span>(n, -<span class="dv">1</span>, <span class="dv">1</span>)
  y =<span class="st"> </span><span class="dv">1</span> *<span class="st"> </span>(x1 ^<span class="st"> </span><span class="dv">2</span> +<span class="st"> </span>x2 ^<span class="st"> </span><span class="dv">2</span> +<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.25</span>) &lt;<span class="st"> </span><span class="fl">0.5</span>)
  y =<span class="st"> </span><span class="kw">ifelse</span>(y ==<span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;Orange&quot;</span>, <span class="st">&quot;Blue&quot;</span>)
  <span class="kw">data.frame</span>(<span class="dt">y =</span> <span class="kw">as.factor</span>(y), <span class="dt">x1 =</span> x1, <span class="dt">x2 =</span> x2)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">42</span>)
train_data =<span class="st"> </span><span class="kw">sim_rad</span>(<span class="dt">n =</span> <span class="dv">250</span>)
<span class="kw">plot</span>(x2 ~<span class="st"> </span>x1, <span class="dt">data =</span> train_data, <span class="dt">col =</span> <span class="kw">as.character</span>(y), <span class="dt">pch =</span> <span class="dv">19</span>)</code></pre></div>
<p><img src="32-svm_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">test_data =<span class="st"> </span><span class="kw">sim_rad</span>(<span class="dt">n =</span> <span class="dv">2000</span>)</code></pre></div>
</div>
<div id="radial-kernel-parameter-c" class="section level3">
<h3><span class="header-section-number">32.4.2</span> Radial Kernel, Parameter <code>C</code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rad_svm_fit =<span class="st"> </span><span class="kw">ksvm</span>(y ~., <span class="dt">data =</span> train_data, <span class="dt">kernel =</span> <span class="st">&#39;rbfdot&#39;</span>, 
                   <span class="dt">C =</span> <span class="fl">0.1</span>, <span class="dt">kpar =</span> <span class="kw">list</span>(<span class="dt">sigma =</span> <span class="dv">1</span>))
<span class="kw">plot</span>(rad_svm_fit, <span class="dt">data =</span> train_data)</code></pre></div>
<p><img src="32-svm_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># train accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> train_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(rad_svm_fit, train_data))</code></pre></div>
<pre><code>## [1] 0.852</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># test accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> test_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(rad_svm_fit, test_data))</code></pre></div>
<pre><code>## [1] 0.812</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rad_svm_fit =<span class="st"> </span><span class="kw">ksvm</span>(y ~., <span class="dt">data =</span> train_data, <span class="dt">kernel =</span> <span class="st">&#39;rbfdot&#39;</span>, 
                   <span class="dt">C =</span> <span class="dv">1</span>, <span class="dt">kpar =</span> <span class="kw">list</span>(<span class="dt">sigma =</span> <span class="dv">1</span>))
<span class="kw">plot</span>(rad_svm_fit, <span class="dt">data =</span> train_data)</code></pre></div>
<p><img src="32-svm_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># train accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> train_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(rad_svm_fit, train_data))</code></pre></div>
<pre><code>## [1] 0.876</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># test accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> test_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(rad_svm_fit, test_data))</code></pre></div>
<pre><code>## [1] 0.833</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rad_svm_fit =<span class="st"> </span><span class="kw">ksvm</span>(y ~., <span class="dt">data =</span> train_data, <span class="dt">kernel =</span> <span class="st">&#39;rbfdot&#39;</span>, 
                   <span class="dt">C =</span> <span class="dv">10</span>, <span class="dt">kpar =</span> <span class="kw">list</span>(<span class="dt">sigma =</span> <span class="dv">1</span>))
<span class="kw">plot</span>(rad_svm_fit, <span class="dt">data =</span> train_data)</code></pre></div>
<p><img src="32-svm_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># train accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> train_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(rad_svm_fit, train_data))</code></pre></div>
<pre><code>## [1] 0.884</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># test accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> test_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(rad_svm_fit, test_data))</code></pre></div>
<pre><code>## [1] 0.8285</code></pre>
</div>
<div id="radial-kernel-parameter-sigma" class="section level3">
<h3><span class="header-section-number">32.4.3</span> Radial Kernel, Parameter <code>sigma</code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rad_svm_fit =<span class="st"> </span><span class="kw">ksvm</span>(y ~., <span class="dt">data =</span> train_data, <span class="dt">kernel =</span> <span class="st">&#39;rbfdot&#39;</span>, 
                   <span class="dt">C =</span> <span class="dv">1</span>, <span class="dt">kpar =</span> <span class="kw">list</span>(<span class="dt">sigma =</span> <span class="fl">0.5</span>))
<span class="kw">plot</span>(rad_svm_fit, <span class="dt">data =</span> train_data)</code></pre></div>
<p><img src="32-svm_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># train accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> train_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(rad_svm_fit, train_data))</code></pre></div>
<pre><code>## [1] 0.864</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># test accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> test_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(rad_svm_fit, test_data))</code></pre></div>
<pre><code>## [1] 0.8365</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rad_svm_fit =<span class="st"> </span><span class="kw">ksvm</span>(y ~., <span class="dt">data =</span> train_data, <span class="dt">kernel =</span> <span class="st">&#39;rbfdot&#39;</span>, 
                   <span class="dt">C =</span> <span class="dv">1</span>, <span class="dt">kpar =</span> <span class="kw">list</span>(<span class="dt">sigma =</span> <span class="dv">1</span>))
<span class="kw">plot</span>(rad_svm_fit, <span class="dt">data =</span> train_data)</code></pre></div>
<p><img src="32-svm_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># train accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> train_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(rad_svm_fit, train_data))</code></pre></div>
<pre><code>## [1] 0.876</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># test accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> test_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(rad_svm_fit, test_data))</code></pre></div>
<pre><code>## [1] 0.833</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rad_svm_fit =<span class="st"> </span><span class="kw">ksvm</span>(y ~., <span class="dt">data =</span> train_data, <span class="dt">kernel =</span> <span class="st">&#39;rbfdot&#39;</span>, 
                   <span class="dt">C =</span> <span class="dv">1</span>, <span class="dt">kpar =</span> <span class="kw">list</span>(<span class="dt">sigma =</span> <span class="dv">2</span>))
<span class="kw">plot</span>(rad_svm_fit, <span class="dt">data =</span> train_data)</code></pre></div>
<p><img src="32-svm_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># train accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> train_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(rad_svm_fit, train_data))</code></pre></div>
<pre><code>## [1] 0.884</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># test accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> test_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(rad_svm_fit, test_data))</code></pre></div>
<pre><code>## [1] 0.828</code></pre>
</div>
<div id="radial-kernel-tuning" class="section level3">
<h3><span class="header-section-number">32.4.4</span> Radial Kernel, Tuning</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">svm_grid =<span class="st"> </span><span class="kw">expand.grid</span>(   <span class="dt">C =</span> <span class="kw">c</span>(<span class="dv">2</span> ^<span class="st"> </span>(-<span class="dv">5</span>:<span class="dv">5</span>)),
                      <span class="dt">sigma =</span> <span class="kw">c</span>(<span class="dv">2</span> ^<span class="st"> </span>(-<span class="dv">3</span>:<span class="dv">3</span>)))

<span class="kw">set.seed</span>(<span class="dv">42</span>)
rad_svm_fit =<span class="st"> </span><span class="kw">train</span>(y ~<span class="st"> </span>., <span class="dt">data =</span> train_data, <span class="dt">method =</span> <span class="st">&quot;svmRadial&quot;</span>,
                    <span class="dt">trControl =</span> svm_control, <span class="dt">tuneGrid =</span> svm_grid)
<span class="co">#rad_svm_fit</span>
rad_svm_fit$bestTune</code></pre></div>
<pre><code>##    sigma  C
## 65  0.25 16</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rad_svm_fit =<span class="st"> </span><span class="kw">ksvm</span>(y ~., <span class="dt">data =</span> train_data, <span class="dt">kernel =</span> <span class="st">&#39;rbfdot&#39;</span>,
                  <span class="dt">C =</span> <span class="dv">16</span>, <span class="dt">kpar =</span> <span class="kw">list</span>(<span class="dt">sigma =</span> <span class="fl">0.25</span>))
<span class="kw">plot</span>(rad_svm_fit, <span class="dt">data =</span> train_data)</code></pre></div>
<p><img src="32-svm_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># train accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> train_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(rad_svm_fit, train_data))</code></pre></div>
<pre><code>## [1] 0.876</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># test accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> test_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(rad_svm_fit, test_data))</code></pre></div>
<pre><code>## [1] 0.838</code></pre>
</div>
<div id="polynomial-kernel-tuning" class="section level3">
<h3><span class="header-section-number">32.4.5</span> Polynomial Kernel, Tuning</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">42</span>)
poly_svm_fit =<span class="st"> </span><span class="kw">train</span>(y ~<span class="st"> </span>., <span class="dt">data =</span> train_data, <span class="dt">method =</span> <span class="st">&quot;svmPoly&quot;</span>,
                     <span class="dt">trControl =</span> svm_control)
<span class="co">#poly_svm_fit</span>
poly_svm_fit$bestTune</code></pre></div>
<pre><code>##    degree scale C
## 27      3   0.1 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">poly_svm_fit =<span class="st"> </span><span class="kw">ksvm</span>(y ~., <span class="dt">data =</span> train_data, <span class="dt">kernel =</span> <span class="st">&#39;polydot&#39;</span>, 
                    <span class="dt">C =</span> <span class="dv">1</span>, <span class="dt">kpar =</span> <span class="kw">list</span>(<span class="dt">scale =</span> <span class="fl">0.1</span>, <span class="dt">degree =</span> <span class="dv">3</span>))
<span class="kw">plot</span>(poly_svm_fit, <span class="dt">data =</span> train_data)</code></pre></div>
<p><img src="32-svm_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># train accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> train_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(poly_svm_fit, train_data))</code></pre></div>
<pre><code>## [1] 0.864</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># test accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> test_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(poly_svm_fit, test_data))</code></pre></div>
<pre><code>## [1] 0.8425</code></pre>
</div>
<div id="linear-kernel-tuning" class="section level3">
<h3><span class="header-section-number">32.4.6</span> Linear Kernel, Tuning</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">svm_grid =<span class="st">  </span><span class="kw">expand.grid</span>(<span class="dt">C =</span> <span class="kw">c</span>(<span class="dv">2</span> ^<span class="st"> </span>(-<span class="dv">5</span>:<span class="dv">5</span>)))
<span class="kw">set.seed</span>(<span class="dv">42</span>)
lin_svm_fit =<span class="st"> </span><span class="kw">train</span>(y ~<span class="st"> </span>., <span class="dt">data =</span> train_data, <span class="dt">method =</span> <span class="st">&quot;svmLinear&quot;</span>,
                    <span class="dt">trControl =</span> svm_control, <span class="dt">tuneGrid =</span> svm_grid)
lin_svm_fit</code></pre></div>
<pre><code>## Support Vector Machines with Linear Kernel 
## 
## 250 samples
##   2 predictor
##   2 classes: &#39;Blue&#39;, &#39;Orange&#39; 
## 
## No pre-processing
## Resampling: Cross-Validated (5 fold) 
## Summary of sample sizes: 200, 200, 201, 199, 200 
## Resampling results across tuning parameters:
## 
##   C         Accuracy   Kappa
##    0.03125  0.5920144  0    
##    0.06250  0.5920144  0    
##    0.12500  0.5920144  0    
##    0.25000  0.5920144  0    
##    0.50000  0.5920144  0    
##    1.00000  0.5920144  0    
##    2.00000  0.5920144  0    
##    4.00000  0.5920144  0    
##    8.00000  0.5920144  0    
##   16.00000  0.5920144  0    
##   32.00000  0.5920144  0    
## 
## Accuracy was used to select the optimal model using  the largest value.
## The final value used for the model was C = 0.03125.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lin_svm_fit$bestTune</code></pre></div>
<pre><code>##         C
## 1 0.03125</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lin_svm_fit =<span class="st"> </span><span class="kw">ksvm</span>(y ~., <span class="dt">data =</span> train_data, <span class="dt">kernel =</span> <span class="st">&#39;vanilladot&#39;</span>, 
                   <span class="dt">C =</span> lin_svm_fit$bestTune)</code></pre></div>
<pre><code>##  Setting default kernel parameters</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(lin_svm_fit, <span class="dt">data =</span> train_data)</code></pre></div>
<p><img src="32-svm_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># train accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> train_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(lin_svm_fit, train_data))</code></pre></div>
<pre><code>## [1] 0.592</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># test accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> test_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(lin_svm_fit, test_data))</code></pre></div>
<pre><code>## [1] 0.6005</code></pre>
</div>
<div id="compare-random-forest-1" class="section level3">
<h3><span class="header-section-number">32.4.7</span> Compare: Random Forest</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">42</span>)
rf_grid =<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">mtry =</span> <span class="dv">1</span>:<span class="dv">2</span>)
rf_fit =<span class="st"> </span><span class="kw">train</span>(y ~<span class="st"> </span>., <span class="dt">data =</span> train_data, <span class="dt">method =</span> <span class="st">&quot;rf&quot;</span>,
               <span class="dt">trControl =</span> svm_control, <span class="dt">tuneGrid =</span> rf_grid)
rf_fit$bestTune</code></pre></div>
<pre><code>##   mtry
## 2    2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># train accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> train_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(rf_fit, train_data))</code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># test accuracy</span>
<span class="kw">accuracy</span>(<span class="dt">actual =</span> test_data$y,
         <span class="dt">predicted =</span> <span class="kw">predict</span>(rf_fit, test_data))</code></pre></div>
<pre><code>## [1] 0.809</code></pre>
</div>
</div>
<div id="external-links-12" class="section level2">
<h2><span class="header-section-number">32.5</span> External Links</h2>
<ul>
<li><a href="https://www.youtube.com/watch?v=3liCbRZPrZA">SVM with Polynomial Kernel Visualization</a> - The kernel idea in one simple video.</li>
</ul>
</div>
<div id="rmarkdown-14" class="section level2">
<h2><span class="header-section-number">32.6</span> RMarkdown</h2>
<p>The RMarkdown file for this chapter can be found <a href="21-svm.Rmd"><strong>here</strong></a>. The file was created using <code>R</code> version 3.4.1 and the following packages:</p>
<ul>
<li>Base Packages, Attached</li>
</ul>
<pre><code>## [1] &quot;methods&quot;   &quot;stats&quot;     &quot;graphics&quot;  &quot;grDevices&quot; &quot;utils&quot;     &quot;datasets&quot; 
## [7] &quot;base&quot;</code></pre>
<ul>
<li>Additional Packages, Attached</li>
</ul>
<pre><code>## [1] &quot;kernlab&quot;      &quot;caret&quot;        &quot;ggplot2&quot;      &quot;lattice&quot;     
## [5] &quot;randomForest&quot;</code></pre>
<ul>
<li>Additional Packages, Not Attached</li>
</ul>
<pre><code>##  [1] &quot;Rcpp&quot;         &quot;nloptr&quot;       &quot;compiler&quot;     &quot;plyr&quot;        
##  [5] &quot;class&quot;        &quot;iterators&quot;    &quot;tools&quot;        &quot;digest&quot;      
##  [9] &quot;lme4&quot;         &quot;evaluate&quot;     &quot;tibble&quot;       &quot;gtable&quot;      
## [13] &quot;nlme&quot;         &quot;mgcv&quot;         &quot;rlang&quot;        &quot;Matrix&quot;      
## [17] &quot;foreach&quot;      &quot;parallel&quot;     &quot;yaml&quot;         &quot;SparseM&quot;     
## [21] &quot;e1071&quot;        &quot;stringr&quot;      &quot;knitr&quot;        &quot;MatrixModels&quot;
## [25] &quot;stats4&quot;       &quot;rprojroot&quot;    &quot;grid&quot;         &quot;nnet&quot;        
## [29] &quot;rmarkdown&quot;    &quot;bookdown&quot;     &quot;minqa&quot;        &quot;reshape2&quot;    
## [33] &quot;car&quot;          &quot;magrittr&quot;     &quot;backports&quot;    &quot;scales&quot;      
## [37] &quot;codetools&quot;    &quot;ModelMetrics&quot; &quot;htmltools&quot;    &quot;MASS&quot;        
## [41] &quot;splines&quot;      &quot;pbkrtest&quot;     &quot;colorspace&quot;   &quot;quantreg&quot;    
## [45] &quot;stringi&quot;      &quot;lazyeval&quot;     &quot;munsell&quot;</code></pre>

<div id="refs" class="references">

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="regularized-discriminant-analysis.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/daviddalpiaz/r4sl/edit/master/32-svm.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
